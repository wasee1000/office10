<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Project Management Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        .project-card {
            transition: all 0.3s ease;
        }
        .project-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }
        .progress-bar {
            transition: width 0.5s ease-in-out;
        }
        .alert-pulse {
            animation: pulse 2s infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body id="mainBody" class="bg-gray-50 min-h-screen transition-colors duration-300">
    <!-- Header -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div class="flex items-center">
                    <div class="bg-blue-600 rounded-lg p-2 mr-3">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"/>
                        </svg>
                    </div>
                    <h1 class="text-2xl font-bold text-gray-900">Project Dashboard</h1>
                </div>
                <div class="flex items-center space-x-4">
                     
                    <div class="w-8 h-8 bg-blue-600 rounded-full flex items-center justify-center text-white font-semibold">
                        TL
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
            <div class="bg-white rounded-lg shadow p-6 fade-in">
                <div class="flex items-center">
                    <div class="bg-blue-100 rounded-lg p-3">
                        <svg class="w-6 h-6 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Active Projects</p>
                        <p class="text-2xl font-semibold text-gray-900" id="activeProjects">8</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6 fade-in">
                <div class="flex items-center">
                    <div class="bg-green-100 rounded-lg p-3">
                        <svg class="w-6 h-6 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Team Members</p>
                        <p class="text-2xl font-semibold text-gray-900" id="teamMembers">12</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6 fade-in">
                <div class="flex items-center">
                    <div class="bg-yellow-100 rounded-lg p-3">
                        <svg class="w-6 h-6 text-yellow-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Due This Week</p>
                        <p class="text-2xl font-semibold text-gray-900" id="dueThisWeek">3</p>
                    </div>
                </div>
            </div>
            
            <div class="bg-white rounded-lg shadow p-6 fade-in">
                <div class="flex items-center">
                    <div class="bg-purple-100 rounded-lg p-3">
                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"/>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-500">Avg Progress</p>
                        <p class="text-2xl font-semibold text-gray-900" id="avgProgress">74%</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="mb-8">
            <nav class="flex space-x-8">
                <button class="nav-tab border-b-2 border-blue-500 text-blue-600 py-2 px-1 font-medium" data-tab="projects">
                    Projects Overview
                </button>
                <button class="nav-tab border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 font-medium" data-tab="attendance">
                    Team Attendance
                </button>
                <button class="nav-tab border-b-2 border-transparent text-gray-500 hover:text-gray-700 py-2 px-1 font-medium" data-tab="deadlines">
                    Deadlines & Alerts
                </button>
            </nav>
        </div>

        <!-- Projects Tab -->
        <div id="projects-tab" class="tab-content">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-xl font-semibold text-gray-900">Current Running Projects</h2>
                <button onclick="openProjectModal()" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"/>
                    </svg>
                    <span>New Project</span>
                </button>
            </div>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6" id="projectsGrid">
                <!-- Projects will be dynamically inserted here -->
            </div>
        </div>

        <!-- Attendance Tab -->
        <div id="attendance-tab" class="tab-content hidden">
            <div class="bg-white rounded-lg shadow">
                <div class="px-6 py-4 border-b border-gray-200">
                    <h3 class="text-lg font-medium text-gray-900">Team Attendance Overview</h3>
                    <p class="text-sm text-gray-500">Today - July 28, 2025</p>
                </div>
                <div class="p-6">
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                        <div class="text-center p-4 bg-green-50 rounded-lg">
                            <div class="text-2xl font-bold text-green-600">10</div>
                            <div class="text-sm text-green-700">Present</div>
                        </div>
                        <div class="text-center p-4 bg-red-50 rounded-lg">
                            <div class="text-2xl font-bold text-red-600">1</div>
                            <div class="text-sm text-red-700">Absent</div>
                        </div>
                        <div class="text-center p-4 bg-yellow-50 rounded-lg">
                            <div class="text-2xl font-bold text-yellow-600">1</div>
                            <div class="text-sm text-yellow-700">Late</div>
                        </div>
                    </div>
                    
                    <div class="overflow-x-auto">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Team Member</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Check-in Time</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Activity Log</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200" id="attendanceTable">
                                <!-- Attendance data will be inserted here -->
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Deadlines Tab -->
        <div id="deadlines-tab" class="tab-content hidden">
            <div class="space-y-6">
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Upcoming Deadlines</h3>
                    <div class="space-y-4" id="deadlinesList">
                        <!-- Deadlines will be inserted here -->
                    </div>
                </div>
                
                <div class="bg-white rounded-lg shadow p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Project Timeline</h3>
                    <div id="timelineChartContainer">
                        <canvas id="timelineChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Project Modal -->
    <div id="projectModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
        <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
            <div class="mt-3">
                <h3 class="text-lg font-medium text-gray-900 mb-4">Add New Project</h3>
                <form id="projectForm">
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Project Name</label>
                        <input type="text" id="projectName" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Assigned Team Members</label>
                        <select multiple id="assignedMembers" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="john">John Smith</option>
                            <option value="sarah">Sarah Johnson</option>
                            <option value="mike">Mike Wilson</option>
                            <option value="emily">Emily Davis</option>
                        </select>
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Deadline</label>
                        <input type="date" id="projectDeadline" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                    </div>
                    <div class="mb-4">
                        <label class="block text-sm font-medium text-gray-700 mb-2">Priority</label>
                        <select id="projectPriority" class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <option value="low">Low</option>
                            <option value="medium">Medium</option>
                            <option value="high">High</option>
                        </select>
                    </div>
                    <div class="flex justify-end space-x-3">
                        <button type="button" onclick="closeProjectModal()" class="px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50">
                            Cancel
                        </button>
                        <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">
                            Create Project
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Load projects from localStorage or use empty array
        let projects = [];
        const savedProjects = localStorage.getItem('projects');
        if (savedProjects) {
            try {
                projects = JSON.parse(savedProjects);
            } catch (e) {
                projects = [];
            }
        }

        let teamMembers = [
            { name: "John Smith", status: null, checkin: "09:00 AM", activity: "Working on frontend components" },
            { name: "Sarah Johnson", status: null, checkin: "08:45 AM", activity: "Database optimization" },
            { name: "Mike Wilson", status: null, checkin: "10:30 AM", activity: "Code review session" },
            { name: "Emily Davis", status: null, checkin: "09:15 AM", activity: "Mobile UI design" },
            { name: "Tom Brown", status: null, checkin: "N/A", activity: "Sick leave" },
            { name: "Alex Johnson", status: null, checkin: "08:30 AM", activity: "Database migration testing" },
            { name: "Lisa Wong", status: null, checkin: "09:00 AM", activity: "Migration scripts" },
            { name: "David Miller", status: null, checkin: "08:50 AM", activity: "Security vulnerability assessment" },
            { name: "Rachel Green", status: null, checkin: "09:10 AM", activity: "Penetration testing" }
        ];

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            // Load attendance from localStorage
            const savedAttendance = localStorage.getItem('teamAttendance');
            if (savedAttendance) {
                try {
                    const attendanceObj = JSON.parse(savedAttendance);
                    teamMembers.forEach((member, idx) => {
                        if (attendanceObj[idx] !== undefined) {
                            member.status = attendanceObj[idx];
                        }
                    });
                } catch (e) {}
            }
            renderProjects();
            renderAttendance();
            renderDeadlines();
            initializeChart();
            setupTabs();
            updateStats();
        });

        function renderProjects() {
            const grid = document.getElementById('projectsGrid');
            grid.innerHTML = '';

            projects.forEach(project => {
                const card = createProjectCard(project);
                grid.appendChild(card);
            });
        }

        function createProjectCard(project) {
            const div = document.createElement('div');
            div.className = 'bg-white rounded-lg shadow project-card p-6';
            
            const statusColor = {
                'on-track': 'bg-green-100 text-green-800',
                'at-risk': 'bg-yellow-100 text-yellow-800',
                'behind': 'bg-red-100 text-red-800'
            };

            const priorityColor = {
                'high': 'text-red-600',
                'medium': 'text-yellow-600',
                'low': 'text-green-600'
            };

            div.innerHTML = `
                <div class="flex justify-between items-start mb-4">
                    <div class="flex-1">
                        <h3 class="text-lg font-semibold text-gray-900 mb-2">${project.name}</h3>
                        <div class="flex items-center space-x-2 mb-2">
                            <span class="px-2 py-1 text-xs font-medium rounded-full ${statusColor[project.status]}">
                                ${project.status.replace('-', ' ').toUpperCase()}
                            </span>
                            <span class="text-xs font-medium ${priorityColor[project.priority]}">
                                ${project.priority.toUpperCase()} PRIORITY
                            </span>
                        </div>
                    </div>
                    <div class="relative">
                        <button onclick="toggleProjectMenu(${project.id})" class="text-gray-400 hover:text-gray-600">
                            <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M10 6a2 2 0 110-4 2 2 0 010 4zM10 12a2 2 0 110-4 2 2 0 010 4zM10 18a2 2 0 110-4 2 2 0 010 4z"/>
                            </svg>
                        </button>
                    </div>
                </div>
                
                <div class="mb-4">
                    <div class="flex justify-between text-sm text-gray-600 mb-1">
                        <span>Progress</span>
                        <span>${project.progress}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2">
                        <div class="progress-bar bg-blue-600 h-2 rounded-full" style="width: ${project.progress}%"></div>
                    </div>
                </div>
                
                <div class="flex justify-between items-center text-sm text-gray-600 mb-4">
                    <span>Tasks: ${project.completed}/${project.tasks}</span>
                    <span>Due: ${new Date(project.deadline).toLocaleDateString()}</span>
                </div>
                
                <div class="flex items-center justify-between">
                    <div class="flex -space-x-2">
                        ${project.team.slice(0, 3).map(member => `
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white">
                                ${member.split(' ').map(n => n[0]).join('')}
                            </div>
                        `).join('')}
                        ${project.team.length > 3 ? `<div class="w-8 h-8 bg-gray-400 rounded-full flex items-center justify-center text-white text-xs font-medium border-2 border-white">+${project.team.length - 3}</div>` : ''}
                    </div>
                    <button onclick="updateProject(${project.id})" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                        Update
                    </button>
                </div>
            `;
            
            return div;
        }

        // --- Daily Attendance Tracking ---
        let selectedDay = getTodayDay(); // 1-based day of month

        // Add date picker UI above attendance table
        function renderAttendanceDatePicker() {
            let picker = document.getElementById('attendanceDatePicker');
            if (!picker) {
                picker = document.createElement('div');
                picker.id = 'attendanceDatePicker';
                picker.className = 'mb-2 flex items-center gap-2';
                const attendanceSection = document.getElementById('attendanceTable').parentElement;
                attendanceSection.insertBefore(picker, attendanceSection.firstChild);
            }
            picker.innerHTML = `
                <label class="font-semibold text-gray-700">Select Day:</label>
                <select id="attendanceDaySelect" class="border rounded px-2 py-1">
                    ${Array.from({length: 30}, (_, i) => `<option value="${i+1}" ${selectedDay === (i+1) ? 'selected' : ''}>Day ${i+1}</option>`).join('')}
                </select>
                <span class="text-xs text-gray-500">(Month: July 2025)</span>
            `;
            document.getElementById('attendanceDaySelect').onchange = function() {
                selectedDay = parseInt(this.value);
                renderAttendance();
            };
        }

        // Get today's day of month (1-30)
        function getTodayDay() {
            const today = new Date();
            if (today.getMonth() === 6 && today.getFullYear() === 2025) {
                return today.getDate();
            }
            return 1; // fallback to 1st if not July 2025
        }

        // Attendance data per day: { '2025-07-28': [status, ...] }
        function getAttendanceKey(day) {
            return `attendance-2025-07-${String(day).padStart(2, '0')}`;
        }

        function loadAttendanceForDay(day) {
            const key = getAttendanceKey(day);
            const data = localStorage.getItem(key);
            if (data) {
                try {
                    return JSON.parse(data);
                } catch (e) {}
            }
            return Array(teamMembers.length).fill(null);
        }

        function saveAttendanceForDay(day, statuses) {
            const key = getAttendanceKey(day);
            localStorage.setItem(key, JSON.stringify(statuses));
        }

        function renderAttendance() {
            renderAttendanceDatePicker();
            const table = document.getElementById('attendanceTable');
            table.innerHTML = '';

            // Load attendance for selected day
            const dayStatuses = loadAttendanceForDay(selectedDay);
            teamMembers.forEach((member, idx) => {
                member.status = dayStatuses[idx];
            });

            teamMembers.forEach((member, idx) => {
                const row = document.createElement('tr');
                const statusClass = {
                    'present': 'bg-green-100 text-green-800',
                    'absent': 'bg-red-100 text-red-800',
                    'late': 'bg-yellow-100 text-yellow-800',
                    undefined: 'bg-gray-100 text-gray-500',
                    null: 'bg-gray-100 text-gray-500',
                };

                // Capitalize first letter for display
                const displayStatus = member.status ? member.status.charAt(0).toUpperCase() + member.status.slice(1) : 'Normal';

                row.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">
                        <div class="flex items-center">
                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-medium mr-3">
                                ${member.name.split(' ').map(n => n[0]).join('')}
                            </div>
                            <div class="text-sm font-medium text-gray-900">${member.name}</div>
                        </div>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <span class="px-2 py-1 text-xs font-medium rounded-full ${statusClass[member.status]}">
                            ${displayStatus}
                        </span>
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                        ${member.checkin || ''}
                    </td>
                    <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500 flex gap-2 items-center">
                        ${member.activity || ''}
                        <button onclick="setAttendance(${idx}, 'present')" class="ml-2 px-2 py-1 rounded text-xs font-semibold border ${member.status === 'present' ? 'bg-green-500 text-white border-green-600' : 'bg-white text-green-600 border-green-500 hover:bg-green-100'}">Present</button>
                        <button onclick="setAttendance(${idx}, 'absent')" class="px-2 py-1 rounded text-xs font-semibold border ${member.status === 'absent' ? 'bg-red-500 text-white border-red-600' : 'bg-white text-red-600 border-red-500 hover:bg-red-100'}">Absent</button>
                        <button onclick="setAttendance(${idx}, 'late')" class="px-2 py-1 rounded text-xs font-semibold border ${member.status === 'late' ? 'bg-yellow-400 text-white border-yellow-600' : 'bg-white text-yellow-600 border-yellow-400 hover:bg-yellow-100'}">Late</button>
                    </td>
                `;
                table.appendChild(row);
            });
            renderTodayAttendanceSummary();
            renderAttendance30DaySummary();
        }

        // Show 30-day summary for each member
        function renderAttendance30DaySummary() {
            let summaryDiv = document.getElementById('attendance30DaySummary');
            if (!summaryDiv) {
                summaryDiv = document.createElement('div');
                summaryDiv.id = 'attendance30DaySummary';
                summaryDiv.className = 'mt-4 p-4 bg-white rounded shadow';
                const attendanceSection = document.getElementById('attendanceTable').parentElement;
                attendanceSection.appendChild(summaryDiv);
            }
            // Calculate totals
            let rows = teamMembers.map((member, idx) => {
                let present = 0, absent = 0, late = 0;
                for (let d = 1; d <= 30; d++) {
                    const statuses = loadAttendanceForDay(d);
                    const status = statuses[idx];
                    if (status === 'present') present++;
                    else if (status === 'absent') absent++;
                    else if (status === 'late') late++;
                }
                // Alternate row color (light mode only)
                const rowBg = idx % 2 === 0 ? 'bg-blue-50' : 'bg-white';
                return `<tr class='${rowBg} hover:bg-blue-100 transition'>
                    <td class='px-4 py-2 border font-medium'>${member.name}</td>
                    <td class='px-4 py-2 border text-green-700 text-center'>${present}</td>
                    <td class='px-4 py-2 border text-red-700 text-center'>${absent}</td>
                    <td class='px-4 py-2 border text-yellow-700 text-center'>${late}</td>
                </tr>`;
            }).join('');
            summaryDiv.innerHTML = `
                <div class="font-semibold mb-2 text-gray-800 flex items-center gap-2">
                    <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2a4 4 0 014-4h2a4 4 0 014 4v2"/></svg>
                    <p class="text-black"> 30-Day Attendance Summary </p>
                </div>
                <div class="overflow-x-auto">
                <table class="min-w-full border text-sm rounded-lg overflow-hidden shadow-sm bg-white border-gray-200">
                    <thead>
                        <tr class="bg-blue-200">
                            <th class="px-4 py-2 border text-left">Member</th>
                            <th class="px-4 py-2 border text-green-700">Present</th>
                            <th class="px-4 py-2 border text-red-700">Absent</th>
                            <th class="px-4 py-2 border text-yellow-700">Late</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${rows}
                    </tbody>
                </table>
                </div>
            `;
        }

        // Show present and absent members for today (28/07/2025)
        function renderTodayAttendanceSummary() {
            let present = [];
            let absent = [];
            let late = [];
            teamMembers.forEach(member => {
                if (member.status === 'present') present.push(member.name);
                else if (member.status === 'absent') absent.push(member.name);
                else if (member.status === 'late') late.push(member.name);
            });
            let summaryDiv = document.getElementById('todayAttendanceSummary');
            if (!summaryDiv) {
                summaryDiv = document.createElement('div');
                summaryDiv.id = 'todayAttendanceSummary';
                summaryDiv.className = 'mb-4 p-4 bg-white rounded shadow';
                const attendanceSection = document.getElementById('attendanceTable').parentElement;
                attendanceSection.insertBefore(summaryDiv, attendanceSection.firstChild);
            }
            summaryDiv.innerHTML = `
                <div class="flex flex-wrap gap-6">
                    <div>
                        <span class="font-semibold text-green-700">Present (${present.length}):</span>
                        <span>${present.length ? present.join(', ') : '<span class=\'text-gray-400\'>None</span>'}</span>
                    </div>
                    <div>
                        <span class="font-semibold text-red-700">Absent (${absent.length}):</span>
                        <span>${absent.length ? absent.join(', ') : '<span class=\'text-gray-400\'>None</span>'}</span>
                    </div>
                    <div>
                        <span class="font-semibold text-yellow-700">Late (${late.length}):</span>
                        <span>${late.length ? late.join(', ') : '<span class=\'text-gray-400\'>None</span>'}</span>
                    </div>
                </div>
                <div class="text-xs text-gray-500 mt-2">Date: 28/07/2025</div>
            `;
        }

        // Mark attendance for a team member for the selected day
        function setAttendance(idx, status) {
            // Load current day's attendance
            const dayStatuses = loadAttendanceForDay(selectedDay);
            dayStatuses[idx] = status;
            saveAttendanceForDay(selectedDay, dayStatuses);
            renderAttendance();
            const displayStatus = status ? status.charAt(0).toUpperCase() + status.slice(1) : 'Normal';
            let type = 'info';
            if (status === 'present') type = 'success';
            else if (status === 'absent') type = 'error';
            else if (status === 'late') type = 'warning';
            showNotification(`${teamMembers[idx].name} marked as ${displayStatus} (Day ${selectedDay})`, type);
        }

        function renderDeadlines() {
            const list = document.getElementById('deadlinesList');
            list.innerHTML = '';

            const upcomingDeadlines = projects
                .filter(p => new Date(p.deadline) <= new Date(Date.now() + 7 * 24 * 60 * 60 * 1000))
                .sort((a, b) => new Date(a.deadline) - new Date(b.deadline));

            upcomingDeadlines.forEach(project => {
                const daysLeft = Math.ceil((new Date(project.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                const urgencyClass = daysLeft <= 2 ? 'border-red-500 bg-red-50' : daysLeft <= 5 ? 'border-yellow-500 bg-yellow-50' : 'border-green-500 bg-green-50';
                
                const div = document.createElement('div');
                div.className = `border-l-4 ${urgencyClass} p-4 rounded-r-lg`;
                div.innerHTML = `
                    <div class="flex justify-between items-center">
                        <div>
                            <h4 class="font-medium text-gray-900">${project.name}</h4>
                            <p class="text-sm text-gray-600">Due: ${new Date(project.deadline).toLocaleDateString()}</p>
                        </div>
                        <div class="text-right">
                            <div class="text-sm font-medium ${daysLeft <= 2 ? 'text-red-600' : daysLeft <= 5 ? 'text-yellow-600' : 'text-green-600'}">
                                ${daysLeft} days left
                            </div>
                            <div class="text-xs text-gray-500">${project.progress}% complete</div>
                        </div>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        function initializeChart() {
            const container = document.getElementById('timelineChartContainer');
            container.innerHTML = '';

            if (!projects.length) {
                container.innerHTML = `<div class="text-center text-gray-400 py-8">No projects to display in timeline.</div>`;
                return;
            }

            // Horizontal scrollable timeline
            const timeline = document.createElement('div');
            timeline.className = 'flex space-x-8 overflow-x-auto py-6 px-2 scrollbar-thin scrollbar-thumb-blue-200 scrollbar-track-blue-50';

            projects.forEach(project => {
                // Status badge color
                let statusColor = 'bg-green-100 text-green-700 border-green-400';
                if (project.status === 'at-risk') statusColor = 'bg-yellow-100 text-yellow-700 border-yellow-400';
                if (project.status === 'behind') statusColor = 'bg-red-100 text-red-700 border-red-400';

                // Calculate days until deadline
                const daysLeft = Math.ceil((new Date(project.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                let daysText = `${daysLeft} day${daysLeft !== 1 ? 's' : ''} left`;
                let daysClass = 'text-green-600';
                if (daysLeft <= 3) daysClass = 'text-red-600';
                else if (daysLeft <= 7) daysClass = 'text-yellow-600';

                // Card for each project
                const card = document.createElement('div');
                card.className = 'min-w-[260px] max-w-xs bg-white rounded-lg shadow border border-gray-200 flex flex-col p-4 relative';
                card.innerHTML = `
                  <div class="flex items-center mb-2 w-full justify-between">
                    <span class="text-xs font-semibold px-2 py-0.5 rounded-full border ${statusColor}">${project.status.replace('-', ' ').replace(/\b\w/g, l => l.toUpperCase())}</span>
                    <span class="text-xs ${daysClass} font-medium">${daysText}</span>
                  </div>
                  <div class="font-bold text-gray-900 text-base text-center w-full truncate mb-3" title="${project.name}">${project.name}</div>
                  
                  <!-- Progress bar section -->
                  <div class="w-full mb-4">
                    <div class="flex justify-between items-center mb-1">
                      <span class="text-xs text-gray-600">Progress</span>
                      <span class="text-xs font-semibold ${project.progress < 30 ? 'text-red-600' : project.progress < 70 ? 'text-yellow-600' : 'text-green-600'}">${project.progress}%</span>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-2.5">
                      <div class="h-2.5 rounded-full ${project.progress < 30 ? 'bg-red-500' : project.progress < 70 ? 'bg-yellow-500' : 'bg-green-500'}" 
                           style="width: ${project.progress}%"></div>
                    </div>
                  </div>
                  
                  <div class="flex flex-wrap gap-1 justify-center mt-2">
                    ${project.team.slice(0, 3).map(member => `<span class='inline-block bg-blue-100 text-blue-700 px-2 py-0.5 rounded text-xs font-medium'>${member}</span>`).join('')}
                    ${project.team.length > 3 ? `<span class='inline-block bg-gray-300 text-gray-700 px-2 py-0.5 rounded text-xs font-medium'>+${project.team.length - 3} more</span>` : ''}
                  </div>
                `;
                timeline.appendChild(card);
            });

            container.appendChild(timeline);
        }

        function setupTabs() {
            const tabs = document.querySelectorAll('.nav-tab');
            const contents = document.querySelectorAll('.tab-content');

            tabs.forEach(tab => {
                tab.addEventListener('click', () => {
                    // Remove active classes
                    tabs.forEach(t => {
                        t.classList.remove('border-blue-500', 'text-blue-600');
                        t.classList.add('border-transparent', 'text-gray-500');
                    });
                    contents.forEach(c => c.classList.add('hidden'));

                    // Add active classes
                    tab.classList.remove('border-transparent', 'text-gray-500');
                    tab.classList.add('border-blue-500', 'text-blue-600');
                    
                    const targetTab = tab.getAttribute('data-tab');
                    document.getElementById(`${targetTab}-tab`).classList.remove('hidden');
                });
            });
        }

        function updateStats() {
            document.getElementById('activeProjects').textContent = projects.length;
            document.getElementById('teamMembers').textContent = teamMembers.length;
            document.getElementById('dueThisWeek').textContent = projects.filter(p => 
                new Date(p.deadline) <= new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)
            ).length;
            
            const avgProgress = Math.round(projects.reduce((sum, p) => sum + p.progress, 0) / projects.length);
            document.getElementById('avgProgress').textContent = avgProgress + '%';
        }

        function openProjectModal() {
            document.getElementById('projectModal').classList.remove('hidden');
        }

        function closeProjectModal() {
            document.getElementById('projectModal').classList.add('hidden');
            document.getElementById('projectForm').reset();
        }

        function toggleProjectMenu(projectId) {
            // Toggle project options menu (placeholder for now)
            console.log('Toggle menu for project:', projectId);
        }

        function updateProject(projectId) {
            // Find and update project progress
            const project = projects.find(p => p.id === projectId);
            if (project) {
                project.progress = Math.min(100, project.progress + 10);
                project.completed = Math.ceil((project.progress / 100) * project.tasks);
                // Save updated projects to localStorage
                localStorage.setItem('projects', JSON.stringify(projects));
                renderProjects();
                updateStats();
                // Show success notification
                showNotification('Project updated successfully!', 'success');
            }
        }

        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            notification.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 fade-in`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                setTimeout(() => {
                    document.body.removeChild(notification);
                }, 300);
            }, 3000);
        }

        // Handle project form submission
        document.getElementById('projectForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const name = document.getElementById('projectName').value;
            const deadline = document.getElementById('projectDeadline').value;
            const priority = document.getElementById('projectPriority').value;
            const assignedMembersSelect = document.getElementById('assignedMembers');
            const selectedMembers = Array.from(assignedMembersSelect.selectedOptions).map(option => {
                const names = {
                    'john': 'John Smith',
                    'sarah': 'Sarah Johnson',
                    'mike': 'Mike Wilson',
                    'emily': 'Emily Davis'
                };
                return names[option.value];
            });

            if (!name || !deadline || selectedMembers.length === 0) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }

            const newProject = {
                id: Date.now(),
                name: name,
                progress: 0,
                deadline: deadline,
                priority: priority,
                team: selectedMembers,
                status: 'on-track',
                tasks: Math.floor(Math.random() * 30) + 10,
                completed: 0
            };

            projects.push(newProject);
            // Save to localStorage
            localStorage.setItem('projects', JSON.stringify(projects));
            renderProjects();
            updateStats();
            closeProjectModal();
            showNotification('New project created successfully!', 'success');
        });

        // Real-time updates simulation
        setInterval(() => {
            // Simulate random progress updates
            if (Math.random() > 0.7) {
                const randomProject = projects[Math.floor(Math.random() * projects.length)];
                if (randomProject.progress < 100) {
                    randomProject.progress = Math.min(100, randomProject.progress + Math.floor(Math.random() * 5));
                    randomProject.completed = Math.ceil((randomProject.progress / 100) * randomProject.tasks);
                    renderProjects();
                    updateStats();
                }
            }
        }, 30000); // Update every 30 seconds

        // Add keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                    case 'n':
                        e.preventDefault();
                        openProjectModal();
                        break;
                    case '1':
                        e.preventDefault();
                        document.querySelector('[data-tab="projects"]').click();
                        break;
                    case '2':
                        e.preventDefault();
                        document.querySelector('[data-tab="attendance"]').click();
                        break;
                    case '3':
                        e.preventDefault();
                        document.querySelector('[data-tab="deadlines"]').click();
                        break;
                }
            }
            
            if (e.key === 'Escape') {
                closeProjectModal();
            }
        });

        // Add search functionality
        function addSearchFeature() {
            const searchContainer = document.createElement('div');
            searchContainer.className = 'mb-4';
            searchContainer.innerHTML = `
                <div class="relative">
                    <input type="text" id="projectSearch" placeholder="Search projects..." 
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/>
                    </svg>
                </div>
            `;
            
            const projectsHeader = document.querySelector('#projects-tab h2').parentElement;
            projectsHeader.insertBefore(searchContainer, projectsHeader.lastElementChild);
            
            document.getElementById('projectSearch').addEventListener('input', function(e) {
                const searchTerm = e.target.value.toLowerCase();
                const filteredProjects = projects.filter(project => 
                    project.name.toLowerCase().includes(searchTerm) ||
                    project.team.some(member => member.toLowerCase().includes(searchTerm))
                );
                
                const grid = document.getElementById('projectsGrid');
                grid.innerHTML = '';
                filteredProjects.forEach(project => {
                    const card = createProjectCard(project);
                    grid.appendChild(card);
                });
            });
        }

        // Initialize search after DOM is ready
        setTimeout(addSearchFeature, 100);

        // Add task management functionality
        function addTaskToProject(projectId, taskName) {
            const project = projects.find(p => p.id === projectId);
            if (project) {
                project.tasks++;
                renderProjects();
                updateStats();
                showNotification(`Task "${taskName}" added to ${project.name}`, 'success');
            }
        }

        // Enhanced project status tracking
        function updateProjectStatus() {
            projects.forEach(project => {
                const daysUntilDeadline = Math.ceil((new Date(project.deadline) - new Date()) / (1000 * 60 * 60 * 24));
                
                if (project.progress >= 90) {
                    project.status = 'on-track';
                } else if (daysUntilDeadline <= 3 && project.progress < 80) {
                    project.status = 'behind';
                } else if (daysUntilDeadline <= 7 && project.progress < 60) {
                    project.status = 'at-risk';
                } else {
                    project.status = 'on-track';
                }
            });
        }

        // Run status update every minute
        setInterval(updateProjectStatus, 60000);

        // Initialize tooltips for better UX
        function initializeTooltips() {
            const tooltipElements = document.querySelectorAll('[title]');
            tooltipElements.forEach(element => {
                element.addEventListener('mouseenter', function(e) {
                    const tooltip = document.createElement('div');
                    tooltip.className = 'absolute bg-gray-800 text-white text-xs rounded px-2 py-1 z-50';
                    tooltip.textContent = e.target.getAttribute('title');
                    tooltip.style.top = (e.target.offsetTop - 30) + 'px';
                    tooltip.style.left = e.target.offsetLeft + 'px';
                    document.body.appendChild(tooltip);
                    
                    e.target.addEventListener('mouseleave', function() {
                        if (tooltip.parentNode) {
                            document.body.removeChild(tooltip);
                        }
                    });
                });
            });
        }

        // Export functionality
        function exportProjectData() {
            const data = {
                projects: projects,
                teamMembers: teamMembers,
                exportDate: new Date().toISOString()
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `project-data-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showNotification('Project data exported successfully!', 'success');
        }

        // Add export button to header
        setTimeout(() => {
            const headerButtons = document.querySelector('header .flex.items-center.space-x-4');
            const exportButton = document.createElement('button');
            exportButton.className = 'bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded text-sm';
            exportButton.textContent = 'Export Data';
            exportButton.onclick = exportProjectData;
            headerButtons.insertBefore(exportButton, headerButtons.lastElementChild);
        }, 200);

        console.log('Project Management Dashboard initialized successfully!');
    </script>
</body>
</html>